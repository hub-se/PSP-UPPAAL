<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE nta PUBLIC "-//Uppaal Team//DTD Flat System 1.1//EN" "flat-1_1.dtd">

<nta>
  <declaration>/*
This model is taken from Havelund, Skou and Larsen, 1997; Formal Modeling and Analysis of an Audio/Video Protocol:
An Industrial Case Study Using UPPAAL.
@author Marc Carwehl
*/
chan A_new_Pn, A_reset, A_frame, A_check;
chan B_new_Pn, B_reset, B_frame, B_check;
broadcast chan A_observe;
broadcast chan B_observe;
broadcast chan B_res_reset;
chan zero, one;

int B_start;
int A_start;
int A_diff, B_diff;

int A_Pn, B_Pn;
int A_eof, A_no, A_msg, A_stop, A_T4, A_S1, A_S2, A_Pf, A_err, A_res;
int B_eof, B_no, B_msg, B_stop, B_T4, B_S1, B_S2, B_Pf, B_err, B_res;
int mayFire = 0;
bool Failure_holds = false;
bool Failure_held_once = false;
broadcast chan Failure_reached;
bool startA_holds = false;
bool startA_held_once = false;
broadcast chan startA_reached;
bool EOF_Reset_holds = false;
bool EOF_Reset_held_once = false;
broadcast chan EOF_Reset_reached;
bool Resolved_holds = false;
bool Resolved_held_once = false;
broadcast chan Resolved_reached;
bool nxtCmt = 0;</declaration>
  <template>
    <name x="0" y="0">Bus</name>
    <declaration>// Place local declarations here.</declaration>
    <location x="204" y="17" id="id0">
      <name x="212" y="-17">active</name>
    </location>
    <location x="204" y="-119" id="id1">
      <name x="194" y="-153">initialize</name>
      <committed />
    </location>
    <init ref="id1" />
    <transition>
      <source ref="id0" />
      <target ref="id0" />
      <label x="0" y="0" kind="guard">A_Pn==0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="8" y="25" kind="synchronisation">zero!</label>
      <nail x="76" y="17" />
      <nail x="76" y="51" />
    </transition>
    <transition>
      <source ref="id0" />
      <target ref="id0" />
      <label x="0" y="0" kind="guard">A_Pn == 1 &amp;&amp;
B_Pn == 1&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="178" y="144" kind="synchronisation">one!</label>
      <nail x="178" y="102" />
      <nail x="229" y="102" />
    </transition>
    <transition>
      <source ref="id0" />
      <target ref="id0" />
      <label x="0" y="0" kind="guard">B_Pn==0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="340" y="34" kind="synchronisation">zero!</label>
      <nail x="331" y="17" />
      <nail x="331" y="51" />
    </transition>
    <transition>
      <source ref="id1" />
      <target ref="id0" />
      <label x="0" y="0" kind="guard">mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="204" y="-51" kind="assignment">A_Pn=1,
B_Pn =1</label>
    </transition>
  </template>
  <template>
    <name x="0" y="0">Frame_Generator_A</name>
    <declaration />
    <location x="-238" y="-289" id="id2">
      <committed />
    </location>
    <location x="-331" y="-289" id="id3">
      <name x="-341" y="-323">EOF_Reset</name>
      <committed />
    </location>
    <location x="59" y="518" id="id4">
      <name x="76" y="510">continue</name>
      <committed />
    </location>
    <location x="59" y="348" id="id5">
      <name x="49" y="314">stop</name>
      <committed />
    </location>
    <location x="-442" y="348" id="id6">
      <name x="-452" y="314">last</name>
    </location>
    <location x="238" y="229" id="id7">
      <name x="246" y="204">set_msg</name>
      <committed />
    </location>
    <location x="-119" y="229" id="id8">
      <name x="-170" y="212">msg</name>
    </location>
    <location x="-119" y="-25" id="id9">
      <name x="-110" y="-51">first</name>
    </location>
    <location x="-119" y="-289" id="id10">
      <name x="-129" y="-323">startA</name>
    </location>
    <location x="0" y="0" id="id86">
      <name x="0" y="0">startA_ENTER</name>
      <committed />
    </location>
    <location x="0" y="0" id="id87">
      <name x="0" y="0" />
      <committed />
    </location>
    <location x="0" y="0" id="id88">
      <name x="0" y="0" />
      <committed />
    </location>
    <location x="0" y="0" id="id89">
      <name x="0" y="0">EOF_Reset_ENTER</name>
      <committed />
    </location>
    <location x="0" y="0" id="id90">
      <name x="0" y="0" />
      <committed />
    </location>
    <init ref="id87" />
    <transition>
      <source ref="id2" />
      <target ref="id86" />
      <label x="0" y="0" kind="guard">mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="0" y="0" kind="assignment">mayFire++,
startA_holds = 1,
startA_held_once = 1</label>
    </transition>
    <transition>
      <source ref="id3" />
      <target ref="id90" />
      <label x="0" y="0" kind="guard">mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="0" y="0" kind="assignment">EOF_Reset_holds = 0,
mayFire++</label>
    </transition>
    <transition>
      <source ref="id6" />
      <target ref="id89" />
      <label x="0" y="0" kind="guard">mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-441" y="-306" kind="synchronisation">A_new_Pn?</label>
      <label x="-441" y="-289" kind="assignment">A_Pn = 1,
A_eof = 1,
A_start = 0,
mayFire++,
EOF_Reset_holds = 1,
EOF_Reset_held_once = 1</label>
      <nail x="-442" y="-289" />
    </transition>
    <transition>
      <source ref="id8" />
      <target ref="id86" />
      <label x="0" y="0" kind="guard">mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-306" y="-229" kind="synchronisation">A_reset?</label>
      <label x="0" y="0" kind="assignment">mayFire++,
startA_holds = 1,
startA_held_once = 1</label>
      <nail x="-323" y="127" />
      <nail x="-323" y="-238" />
    </transition>
    <transition>
      <source ref="id10" />
      <target ref="id88" />
      <label x="0" y="0" kind="guard">mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-119" y="-174" kind="synchronisation">A_frame?</label>
      <label x="-119" y="-157" kind="assignment">A_no=1,
A_msg=10,
A_eof=0,
A_stop=0,
A_T4=0,
startA_holds = 0,
mayFire++</label>
    </transition>
    <transition>
      <source ref="id9" />
      <target ref="id8" />
      <label x="0" y="0" kind="guard">mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-204" y="85" kind="synchronisation">A_new_Pn?</label>
      <label x="-187" y="102" kind="assignment">A_Pn=0</label>
    </transition>
    <transition>
      <source ref="id8" />
      <target ref="id7" />
      <label x="0" y="0" kind="guard">A_T4 == 0 &amp;&amp;
A_msg == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="59" y="-17" kind="synchronisation">A_new_Pn?</label>
      <label x="59" y="8" kind="assignment">A_no=A_no+1,
A_Pn=0,
A_start=1</label>
      <nail x="-67" y="8" />
      <nail x="187" y="8" />
    </transition>
    <transition>
      <source ref="id7" />
      <target ref="id8" />
      <label x="0" y="0" kind="guard">A_no&lt;=2&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-42" y="85" kind="assignment">A_msg=2</label>
      <nail x="187" y="102" />
      <nail x="-59" y="102" />
    </transition>
    <transition>
      <source ref="id7" />
      <target ref="id8" />
      <label x="0" y="0" kind="guard">A_no &gt; 2 &amp;&amp;
A_no &lt;=20&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="110" y="272" kind="assignment">A_msg=8,
A_T4=1</label>
      <nail x="212" y="255" />
      <nail x="-42" y="255" />
    </transition>
    <transition>
      <source ref="id8" />
      <target ref="id6" />
      <label x="0" y="0" kind="guard">A_T4 == 1 &amp;&amp;
A_msg == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-391" y="280" kind="synchronisation">A_new_Pn?</label>
      <label x="-391" y="297" kind="assignment">A_Pn=0</label>
    </transition>
    <transition>
      <source ref="id4" />
      <target ref="id8" />
      <label x="0" y="0" kind="guard">mayFire == 0 &amp;&amp; !nxtCmt</label>
      <nail x="-119" y="518" />
    </transition>
    <transition>
      <source ref="id8" />
      <target ref="id5" />
      <label x="0" y="0" kind="guard">A_msg &gt; 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-85" y="297" kind="synchronisation">A_new_Pn?</label>
      <label x="-85" y="314" kind="assignment">A_Pn=1,
A_msg=A_msg-1</label>
    </transition>
    <transition>
      <source ref="id5" />
      <target ref="id4" />
      <label x="0" y="0" kind="guard">A_T4 == 1 &amp;&amp;
A_msg &lt; 7&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="144" y="433" kind="assignment">A_stop=1</label>
      <nail x="144" y="433" />
    </transition>
    <transition>
      <source ref="id5" />
      <target ref="id4" />
      <label x="0" y="0" kind="guard">A_T4 == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <nail x="-34" y="433" />
    </transition>
    <transition>
      <source ref="id5" />
      <target ref="id4" />
      <label x="0" y="0" kind="guard">A_T4 == 1 &amp;&amp;
A_msg &gt;= 7&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
    </transition>
    <transition>
      <source ref="id87" />
      <target ref="id86" />
      <label x="0" y="0" kind="assignment">mayFire++</label>
    </transition>
    <transition>
      <source ref="id86" />
      <target ref="id10" />
      <label x="0" y="0" kind="synchronisation">startA_reached!</label>
      <label x="0" y="0" kind="assignment">mayFire--</label>
    </transition>
    <transition>
      <source ref="id88" />
      <target ref="id9" />
      <label x="0" y="0" kind="guard">!nxtCmt</label>
      <label x="0" y="0" kind="assignment">mayFire--</label>
    </transition>
    <transition>
      <source ref="id89" />
      <target ref="id3" />
      <label x="0" y="0" kind="synchronisation">EOF_Reset_reached!</label>
      <label x="0" y="0" kind="assignment">mayFire--</label>
    </transition>
    <transition>
      <source ref="id90" />
      <target ref="id2" />
      <label x="0" y="0" kind="guard">!nxtCmt</label>
      <label x="0" y="0" kind="assignment">mayFire--</label>
    </transition>
  </template>
  <template>
    <name x="0" y="0">Frame_Generator_B</name>
    <declaration />
    <location x="-119" y="229" id="id11">
      <name x="-170" y="212">msg</name>
    </location>
    <location x="-119" y="-289" id="id12">
      <name x="-129" y="-323">start</name>
    </location>
    <location x="-119" y="-25" id="id13">
      <name x="-110" y="-51">first</name>
    </location>
    <location x="-442" y="348" id="id14">
      <name x="-452" y="314">last</name>
    </location>
    <location x="238" y="229" id="id15">
      <name x="246" y="204">set_msg</name>
      <committed />
    </location>
    <location x="59" y="518" id="id16">
      <name x="76" y="510">continue</name>
      <committed />
    </location>
    <location x="59" y="348" id="id17">
      <name x="49" y="314">stop</name>
      <committed />
    </location>
    <init ref="id12" />
    <transition>
      <source ref="id11" />
      <target ref="id12" />
      <label x="0" y="0" kind="guard">mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-306" y="-229" kind="synchronisation">B_reset?</label>
      <nail x="-323" y="127" />
      <nail x="-323" y="-238" />
    </transition>
    <transition>
      <source ref="id12" />
      <target ref="id13" />
      <label x="0" y="0" kind="guard">mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-119" y="-174" kind="synchronisation">B_frame?</label>
      <label x="-119" y="-157" kind="assignment">B_no=1,
B_msg=10,
B_eof=0,
B_stop=0,
B_T4=0</label>
    </transition>
    <transition>
      <source ref="id14" />
      <target ref="id12" />
      <label x="0" y="0" kind="guard">mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-424" y="-306" kind="synchronisation">B_new_Pn?</label>
      <label x="-424" y="-289" kind="assignment">B_Pn=1,
B_eof=1,
B_start=0</label>
      <nail x="-442" y="-289" />
    </transition>
    <transition>
      <source ref="id13" />
      <target ref="id11" />
      <label x="0" y="0" kind="guard">mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-204" y="85" kind="synchronisation">B_new_Pn?</label>
      <label x="-187" y="102" kind="assignment">B_Pn=0</label>
    </transition>
    <transition>
      <source ref="id11" />
      <target ref="id15" />
      <label x="0" y="0" kind="guard">B_T4 == 0 &amp;&amp;
B_msg == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="59" y="-17" kind="synchronisation">B_new_Pn?</label>
      <label x="59" y="8" kind="assignment">B_no=B_no+1,
B_Pn=0,
B_start=1</label>
      <nail x="-67" y="8" />
      <nail x="187" y="8" />
    </transition>
    <transition>
      <source ref="id15" />
      <target ref="id11" />
      <label x="0" y="0" kind="guard">B_no&lt;=2&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-42" y="85" kind="assignment">B_msg=2</label>
      <nail x="187" y="102" />
      <nail x="-59" y="102" />
    </transition>
    <transition>
      <source ref="id15" />
      <target ref="id11" />
      <label x="0" y="0" kind="guard">B_no &gt; 2 &amp;&amp;
B_no &lt;=20&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="110" y="272" kind="assignment">B_msg=8,
B_T4=1</label>
      <nail x="212" y="255" />
      <nail x="-42" y="255" />
    </transition>
    <transition>
      <source ref="id11" />
      <target ref="id14" />
      <label x="0" y="0" kind="guard">B_T4 == 1 &amp;&amp;
B_msg == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-391" y="280" kind="synchronisation">B_new_Pn?</label>
      <label x="-391" y="297" kind="assignment">B_Pn=0</label>
    </transition>
    <transition>
      <source ref="id16" />
      <target ref="id11" />
      <label x="0" y="0" kind="guard">mayFire == 0 &amp;&amp; !nxtCmt</label>
      <nail x="-119" y="518" />
    </transition>
    <transition>
      <source ref="id11" />
      <target ref="id17" />
      <label x="0" y="0" kind="guard">B_msg &gt; 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-85" y="297" kind="synchronisation">B_new_Pn?</label>
      <label x="-85" y="314" kind="assignment">B_Pn=1,
B_msg=B_msg-1</label>
    </transition>
    <transition>
      <source ref="id17" />
      <target ref="id16" />
      <label x="0" y="0" kind="guard">B_T4 == 1 &amp;&amp;
B_msg &lt; 7&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="144" y="433" kind="assignment">A_stop=1</label>
      <nail x="144" y="433" />
    </transition>
    <transition>
      <source ref="id17" />
      <target ref="id16" />
      <label x="0" y="0" kind="guard">B_T4 == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <nail x="-34" y="433" />
    </transition>
    <transition>
      <source ref="id17" />
      <target ref="id16" />
      <label x="0" y="0" kind="guard">B_T4 == 1 &amp;&amp;
B_msg &gt;= 7&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
    </transition>
  </template>
  <template>
    <name x="0" y="0">Detector_A</name>
    <declaration />
    <location x="-85" y="-714" id="id18">
      <name x="-95" y="-748">ex_Pf</name>
      <committed />
    </location>
    <location x="-85" y="-450" id="id19">
      <name x="-136" y="-484">ex_S1</name>
      <committed />
    </location>
    <location x="-85" y="-221" id="id20">
      <name x="-136" y="-238">ex_Pn</name>
      <committed />
    </location>
    <location x="-85" y="-34" id="id21">
      <name x="-136" y="-68">ex_S2</name>
      <committed />
    </location>
    <location x="314" y="-25" id="id22">
      <name x="323" y="-59">ex1_S1</name>
      <committed />
    </location>
    <location x="314" y="204" id="id23">
      <committed />
    </location>
    <location x="-501" y="382" id="id24">
      <name x="-552" y="391">calc_res</name>
      <committed />
    </location>
    <location x="-501" y="204" id="id25">
      <name x="-561" y="170">wait_call</name>
    </location>
    <init ref="id25" />
    <transition>
      <source ref="id22" />
      <target ref="id23" />
      <label x="0" y="0" kind="guard">A_S1 == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
    </transition>
    <transition>
      <source ref="id21" />
      <target ref="id22" />
      <label x="0" y="0" kind="guard">A_S2 == 1&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
    </transition>
    <transition>
      <source ref="id20" />
      <target ref="id21" />
      <label x="0" y="0" kind="guard">A_Pn == 1&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
    </transition>
    <transition>
      <source ref="id20" />
      <target ref="id22" />
      <label x="0" y="0" kind="guard">A_Pn == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
    </transition>
    <transition>
      <source ref="id18" />
      <target ref="id22" />
      <label x="0" y="0" kind="guard">A_Pf == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <nail x="314" y="-714" />
    </transition>
    <transition>
      <source ref="id19" />
      <target ref="id20" />
      <label x="0" y="0" kind="guard">A_S1 == 0 &amp;&amp;
A_err &lt;= 3&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="42" y="-391" kind="assignment">A_err=A_err+1</label>
      <nail x="42" y="-433" />
      <nail x="42" y="-238" />
    </transition>
    <transition>
      <source ref="id19" />
      <target ref="id20" />
      <label x="0" y="0" kind="guard">A_S1 == 0 &amp;&amp;
A_err &gt; 3&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <nail x="-59" y="-433" />
      <nail x="-59" y="-238" />
    </transition>
    <transition>
      <source ref="id19" />
      <target ref="id20" />
      <label x="0" y="0" kind="guard">A_S1 == 1&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <nail x="-85" y="-238" />
    </transition>
    <transition>
      <source ref="id18" />
      <target ref="id19" />
      <label x="0" y="0" kind="guard">A_Pf == 1&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
    </transition>
    <transition>
      <source ref="id25" />
      <target ref="id18" />
      <label x="0" y="0" kind="guard">mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-483" y="-731" kind="synchronisation">A_check?</label>
      <label x="-483" y="-714" kind="assignment">A_res=0</label>
      <nail x="-501" y="-714" />
    </transition>
    <transition>
      <source ref="id21" />
      <target ref="id25" />
      <label x="0" y="0" kind="guard">A_S2 == 0 &amp;&amp;
A_err &gt; 3&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <nail x="-306" y="51" />
    </transition>
    <transition>
      <source ref="id21" />
      <target ref="id25" />
      <label x="0" y="0" kind="guard">A_S2 == 0 &amp;&amp;
A_err &lt;= 3&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-246" y="110" kind="assignment">A_err=A_err+1</label>
      <nail x="-263" y="119" />
    </transition>
    <transition>
      <source ref="id22" />
      <target ref="id24" />
      <label x="0" y="0" kind="guard">A_S1 == 1&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <nail x="484" y="-25" />
      <nail x="484" y="382" />
    </transition>
    <transition>
      <source ref="id23" />
      <target ref="id24" />
      <label x="0" y="0" kind="guard">A_S2 == 1&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
    </transition>
    <transition>
      <source ref="id23" />
      <target ref="id25" />
      <label x="0" y="0" kind="guard">A_S2 == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
    </transition>
    <transition>
      <source ref="id24" />
      <target ref="id25" />
      <label x="0" y="0" kind="guard">A_err == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-663" y="272" kind="assignment">A_res=0</label>
      <nail x="-603" y="280" />
    </transition>
    <transition>
      <source ref="id24" />
      <target ref="id25" />
      <label x="0" y="0" kind="guard">A_err &gt; 3&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-399" y="289" kind="assignment">A_res=2</label>
      <nail x="-382" y="280" />
    </transition>
    <transition>
      <source ref="id24" />
      <target ref="id25" />
      <label x="0" y="0" kind="guard">A_err &gt; 0 &amp;&amp;
A_err &lt;= 3&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-544" y="297" kind="assignment">A_res=1</label>
    </transition>
  </template>
  <template>
    <name x="0" y="0">Detector_B</name>
    <declaration />
    <location x="-408" y="-714" id="id26">
      <committed />
    </location>
    <location x="314" y="-25" id="id27">
      <name x="323" y="-59">ex1_S1</name>
      <committed />
    </location>
    <location x="314" y="204" id="id28">
      <committed />
    </location>
    <location x="-85" y="-34" id="id29">
      <name x="-136" y="-68">ex_S2</name>
      <committed />
    </location>
    <location x="-85" y="-221" id="id30">
      <name x="-136" y="-238">ex_Pn</name>
      <committed />
    </location>
    <location x="-85" y="-714" id="id31">
      <name x="-95" y="-748">ex_Pf</name>
      <committed />
    </location>
    <location x="-85" y="-450" id="id32">
      <name x="-136" y="-484">ex_S1</name>
      <committed />
    </location>
    <location x="-501" y="204" id="id33">
      <name x="-561" y="170">wait_call</name>
    </location>
    <location x="-501" y="382" id="id34">
      <name x="-552" y="391">calc_res</name>
      <committed />
    </location>
    <init ref="id33" />
    <transition>
      <source ref="id26" />
      <target ref="id31" />
      <label x="0" y="0" kind="guard">mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-390" y="-731" kind="synchronisation">B_res_reset!</label>
      <label x="-390" y="-714" kind="assignment">B_res = 0</label>
    </transition>
    <transition>
      <source ref="id33" />
      <target ref="id26" />
      <label x="0" y="0" kind="guard">mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-483" y="-731" kind="synchronisation">B_check?</label>
      <nail x="-501" y="-714" />
    </transition>
    <transition>
      <source ref="id27" />
      <target ref="id28" />
      <label x="0" y="0" kind="guard">B_S1 == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
    </transition>
    <transition>
      <source ref="id29" />
      <target ref="id27" />
      <label x="0" y="0" kind="guard">B_S2 == 1&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
    </transition>
    <transition>
      <source ref="id30" />
      <target ref="id29" />
      <label x="0" y="0" kind="guard">B_Pn == 1&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
    </transition>
    <transition>
      <source ref="id30" />
      <target ref="id27" />
      <label x="0" y="0" kind="guard">B_Pn == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
    </transition>
    <transition>
      <source ref="id31" />
      <target ref="id27" />
      <label x="0" y="0" kind="guard">B_Pf == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <nail x="314" y="-714" />
    </transition>
    <transition>
      <source ref="id32" />
      <target ref="id30" />
      <label x="0" y="0" kind="guard">B_S1 == 0 &amp;&amp;
B_err &lt;= 3&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="42" y="-391" kind="assignment">B_err=B_err+1</label>
      <nail x="42" y="-433" />
      <nail x="42" y="-238" />
    </transition>
    <transition>
      <source ref="id32" />
      <target ref="id30" />
      <label x="0" y="0" kind="guard">B_S1 == 0 &amp;&amp;
B_err &gt; 3&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <nail x="-59" y="-433" />
      <nail x="-59" y="-238" />
    </transition>
    <transition>
      <source ref="id32" />
      <target ref="id30" />
      <label x="0" y="0" kind="guard">B_S1 == 1&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <nail x="-85" y="-238" />
    </transition>
    <transition>
      <source ref="id31" />
      <target ref="id32" />
      <label x="0" y="0" kind="guard">B_Pf == 1&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
    </transition>
    <transition>
      <source ref="id29" />
      <target ref="id33" />
      <label x="0" y="0" kind="guard">B_S2 == 0 &amp;&amp;
B_err &gt; 3&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <nail x="-306" y="51" />
    </transition>
    <transition>
      <source ref="id29" />
      <target ref="id33" />
      <label x="0" y="0" kind="guard">B_S2 == 0 &amp;&amp;
B_err &lt;= 3&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-246" y="110" kind="assignment">B_err=B_err+1</label>
      <nail x="-263" y="119" />
    </transition>
    <transition>
      <source ref="id27" />
      <target ref="id34" />
      <label x="0" y="0" kind="guard">B_S1 == 1&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <nail x="484" y="-25" />
      <nail x="484" y="382" />
    </transition>
    <transition>
      <source ref="id28" />
      <target ref="id34" />
      <label x="0" y="0" kind="guard">B_S2 == 1&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
    </transition>
    <transition>
      <source ref="id28" />
      <target ref="id33" />
      <label x="0" y="0" kind="guard">B_S2 == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
    </transition>
    <transition>
      <source ref="id34" />
      <target ref="id33" />
      <label x="0" y="0" kind="guard">B_err == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-671" y="238" kind="synchronisation">B_res_reset!</label>
      <label x="-663" y="272" kind="assignment">B_res=0</label>
      <nail x="-603" y="280" />
    </transition>
    <transition>
      <source ref="id34" />
      <target ref="id33" />
      <label x="0" y="0" kind="guard">B_err &gt; 3&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-399" y="289" kind="assignment">B_res=2</label>
      <nail x="-382" y="280" />
    </transition>
    <transition>
      <source ref="id34" />
      <target ref="id33" />
      <label x="0" y="0" kind="guard">B_err &gt; 0 &amp;&amp;
B_err &lt;= 3&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-544" y="297" kind="assignment">B_res=1</label>
    </transition>
  </template>
  <template>
    <name x="0" y="0">Sender_A</name>
    <declaration>clock A_c;</declaration>
    <location x="-561" y="1105" id="id35">
      <name x="-595" y="1079">jam</name>
      <label x="-663" y="1105" kind="invariant">A_c&lt;=25000</label>
    </location>
    <location x="187" y="841" id="id36">
      <name x="177" y="807">hold</name>
      <label x="177" y="858" kind="invariant">A_c&lt;=28116</label>
    </location>
    <location x="-161" y="841" id="id37">
      <name x="-171" y="807">until_silence</name>
      <label x="-178" y="790" kind="invariant">A_c&lt;=781</label>
    </location>
    <location x="187" y="603" id="id38">
      <name x="204" y="586">call_observe</name>
      <committed />
    </location>
    <location x="-161" y="603" id="id39">
      <name x="-171" y="569">call_check</name>
      <committed />
    </location>
    <location x="-561" y="603" id="id40">
      <name x="-612" y="569">ex_jam</name>
      <label x="-646" y="586" kind="invariant">A_c&lt;=781</label>
    </location>
    <location x="187" y="374" id="id41">
      <name x="177" y="340">sample</name>
      <label x="204" y="365" kind="invariant">A_c&lt;=781</label>
    </location>
    <location x="-561" y="374" id="id42">
      <name x="-620" y="374">newPn</name>
      <label x="-620" y="391" kind="invariant">A_c&lt;=40</label>
    </location>
    <location x="-705" y="221" id="id43">
      <name x="-715" y="187">nPf</name>
      <committed />
    </location>
    <location x="187" y="221" id="id44">
      <name x="195" y="187">transmit</name>
      <label x="177" y="238" kind="invariant">A_c&lt;=781</label>
    </location>
    <location x="-561" y="221" id="id45">
      <name x="-561" y="187">check_eof</name>
      <committed />
    </location>
    <location x="374" y="-93" id="id46">
      <name x="382" y="-127">goto_idle</name>
      <committed />
    </location>
    <location x="187" y="-195" id="id47">
      <name x="177" y="-229">ex_silence1</name>
      <label x="204" y="-212" kind="invariant">A_c&lt;=2343</label>
    </location>
    <location x="187" y="34" id="id48">
      <name x="93" y="8">ex_silence2</name>
      <label x="102" y="25" kind="invariant">A_c&lt;=781</label>
    </location>
    <location x="-561" y="34" id="id49">
      <name x="-595" y="0">stop</name>
      <label x="-663" y="25" kind="invariant">A_c&lt;=50000</label>
    </location>
    <location x="-306" y="-8" id="id50">
      <name x="-408" y="-34">other_started</name>
      <label x="-408" y="-17" kind="invariant">A_c &lt;= 3124</label>
    </location>
    <location x="-306" y="-195" id="id51">
      <name x="-316" y="-229">ex_start</name>
      <committed />
    </location>
    <location x="-561" y="-195" id="id52">
      <name x="-595" y="-229">idle</name>
      <label x="-595" y="-178" kind="invariant">A_c&lt;=781</label>
    </location>
    <location x="-688" y="-195" id="id53">
      <name x="-698" y="-229">start</name>
    </location>
    <init ref="id53" />
    <transition>
      <source ref="id35" />
      <target ref="id44" />
      <label x="0" y="0" kind="guard">A_c == 25000&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-416" y="1105" kind="assignment">A_Pn=1,
A_start=0,
A_res=0,
A_c=0</label>
      <nail x="357" y="1105" />
      <nail x="357" y="221" />
    </transition>
    <transition>
      <source ref="id36" />
      <target ref="id46" />
      <label x="0" y="0" kind="guard">A_c == 28116&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="238" y="841" kind="assignment">A_res=0</label>
      <nail x="399" y="841" />
      <nail x="399" y="-93" />
    </transition>
    <transition>
      <source ref="id40" />
      <target ref="id35" />
      <label x="0" y="0" kind="guard">A_c == 781 &amp;&amp;
A_res == 1&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-561" y="837" kind="synchronisation">A_reset!</label>
      <label x="-561" y="854" kind="assignment">A_Pn=0,
A_c=0</label>
    </transition>
    <transition>
      <source ref="id37" />
      <target ref="id37" />
      <label x="0" y="0" kind="guard">A_c == 781&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-204" y="918" kind="synchronisation">zero?</label>
      <label x="-204" y="935" kind="assignment">A_c=0</label>
      <nail x="-204" y="901" />
      <nail x="-119" y="901" />
    </transition>
    <transition>
      <source ref="id40" />
      <target ref="id37" />
      <label x="0" y="0" kind="guard">A_c == 781 &amp;&amp;
A_res == 2&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-297" y="697" kind="synchronisation">A_reset!</label>
      <label x="-297" y="714" kind="assignment">A_Pn=1,
A_start=0,
A_c=0</label>
    </transition>
    <transition>
      <source ref="id37" />
      <target ref="id36" />
      <label x="0" y="0" kind="guard">A_c == 781&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-25" y="824" kind="synchronisation">one?</label>
      <label x="-25" y="841" kind="assignment">A_c=0</label>
    </transition>
    <transition>
      <source ref="id41" />
      <target ref="id38" />
      <label x="0" y="0" kind="guard">A_c == 781&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="187" y="459" kind="synchronisation">one?</label>
      <label x="187" y="476" kind="assignment">A_S2=1</label>
    </transition>
    <transition>
      <source ref="id41" />
      <target ref="id38" />
      <label x="0" y="0" kind="guard">A_c == 781&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="85" y="459" kind="synchronisation">zero?</label>
      <label x="85" y="476" kind="assignment">A_S2=0</label>
      <nail x="170" y="425" />
      <nail x="170" y="578" />
    </transition>
    <transition>
      <source ref="id38" />
      <target ref="id39" />
      <label x="0" y="0" kind="guard">mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-51" y="586" kind="synchronisation">A_observe!</label>
    </transition>
    <transition>
      <source ref="id39" />
      <target ref="id40" />
      <label x="0" y="0" kind="guard">A_stop == 1&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-509" y="561" kind="assignment">A_res=0,
A_c=0</label>
      <nail x="-187" y="561" />
      <nail x="-527" y="561" />
    </transition>
    <transition>
      <source ref="id39" />
      <target ref="id40" />
      <label x="0" y="0" kind="guard">A_stop == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-365" y="603" kind="synchronisation">A_check!</label>
      <label x="-365" y="620" kind="assignment">A_c=0</label>
    </transition>
    <transition>
      <source ref="id40" />
      <target ref="id43" />
      <label x="0" y="0" kind="guard">A_c == 781 &amp;&amp;
A_res == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <nail x="-705" y="603" />
    </transition>
    <transition>
      <source ref="id42" />
      <target ref="id41" />
      <label x="0" y="0" kind="guard">A_c == 40 &amp;&amp;
A_err &gt; 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-161" y="433" kind="assignment">A_Pn=1</label>
      <nail x="-518" y="416" />
      <nail x="153" y="416" />
    </transition>
    <transition>
      <source ref="id42" />
      <target ref="id41" />
      <label x="0" y="0" kind="guard">A_c == 40 &amp;&amp;
A_err == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-272" y="374" kind="synchronisation">A_new_Pn!</label>
    </transition>
    <transition>
      <source ref="id48" />
      <target ref="id44" />
      <label x="0" y="0" kind="guard">A_c == 781&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="187" y="110" kind="synchronisation">one?</label>
      <label x="187" y="127" kind="assignment">A_c=0</label>
    </transition>
    <transition>
      <source ref="id44" />
      <target ref="id45" />
      <label x="0" y="0" kind="guard">A_c == 781&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-374" y="204" kind="synchronisation">A_frame!</label>
      <label x="-374" y="221" kind="assignment">A_err=0,
A_diff=0,
A_Pf=1</label>
    </transition>
    <transition>
      <source ref="id45" />
      <target ref="id42" />
      <label x="0" y="0" kind="guard">A_eof == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-527" y="297" kind="synchronisation">one?</label>
      <label x="-535" y="314" kind="assignment">A_S1=1,
A_c=0</label>
      <nail x="-527" y="289" />
    </transition>
    <transition>
      <source ref="id45" />
      <target ref="id42" />
      <label x="0" y="0" kind="guard">A_eof == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-637" y="314" kind="synchronisation">zero?</label>
      <label x="-637" y="331" kind="assignment">A_S1=0,
A_c=0</label>
      <nail x="-595" y="289" />
    </transition>
    <transition>
      <source ref="id43" />
      <target ref="id45" />
      <label x="0" y="0" kind="guard">A_Pn == 1&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-687" y="242" kind="assignment">A_Pf=1</label>
      <nail x="-629" y="263" />
    </transition>
    <transition>
      <source ref="id43" />
      <target ref="id45" />
      <label x="0" y="0" kind="guard">A_Pn == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-688" y="187" kind="assignment">A_Pf=0</label>
      <nail x="-629" y="187" />
    </transition>
    <transition>
      <source ref="id45" />
      <target ref="id49" />
      <label x="0" y="0" kind="guard">A_eof == 1&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-561" y="110" kind="assignment">A_c=0</label>
    </transition>
    <transition>
      <source ref="id46" />
      <target ref="id52" />
      <label x="0" y="0" kind="guard">mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-119" y="-314" kind="assignment">A_c=0</label>
      <nail x="374" y="-297" />
      <nail x="-561" y="-297" />
    </transition>
    <transition>
      <source ref="id49" />
      <target ref="id52" />
      <label x="0" y="0" kind="guard">A_c == 50000&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-612" y="-93" kind="assignment">A_c=0</label>
    </transition>
    <transition>
      <source ref="id47" />
      <target ref="id46" />
      <label x="0" y="0" kind="guard">A_c == 2343&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="289" y="-161" kind="synchronisation">zero?</label>
    </transition>
    <transition>
      <source ref="id48" />
      <target ref="id46" />
      <label x="0" y="0" kind="guard">A_c == 781&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="238" y="-42" kind="synchronisation">zero?</label>
    </transition>
    <transition>
      <source ref="id47" />
      <target ref="id48" />
      <label x="0" y="0" kind="guard">A_c == 2343&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="153" y="-93" kind="synchronisation">one?</label>
      <label x="144" y="-76" kind="assignment">A_c=0</label>
    </transition>
    <transition>
      <source ref="id50" />
      <target ref="id47" />
      <label x="0" y="0" kind="guard">A_c == 3124 &amp;&amp;
B_start == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-178" y="-93" kind="assignment">A_c = 0</label>
    </transition>
    <transition>
      <source ref="id50" />
      <target ref="id50" />
      <label x="0" y="0" kind="guard">A_c == 3124 &amp;&amp;
B_start == 1&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-323" y="76" kind="assignment">A_c=0</label>
      <nail x="-272" y="42" />
      <nail x="-332" y="42" />
    </transition>
    <transition>
      <source ref="id51" />
      <target ref="id50" />
      <label x="0" y="0" kind="guard">B_start == 1&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-306" y="-119" kind="assignment">A_c = 0</label>
    </transition>
    <transition>
      <source ref="id51" />
      <target ref="id47" />
      <label x="0" y="0" kind="guard">B_start == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-161" y="-195" kind="assignment">A_c=0</label>
    </transition>
    <transition>
      <source ref="id52" />
      <target ref="id51" />
      <label x="0" y="0" kind="guard">A_c == 781&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
    </transition>
    <transition>
      <source ref="id53" />
      <target ref="id52" />
      <label x="0" y="0" kind="guard">mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-654" y="-212" kind="assignment">A_c=0</label>
    </transition>
  </template>
  <template>
    <name x="0" y="0">Sender_B</name>
    <declaration>clock B_c;</declaration>
    <location x="-561" y="1105" id="id54">
      <name x="-595" y="1079">jam</name>
      <label x="-663" y="1105" kind="invariant">B_c&lt;=25000</label>
    </location>
    <location x="187" y="221" id="id55">
      <name x="195" y="187">transmit</name>
      <label x="177" y="238" kind="invariant">B_c&lt;=781</label>
    </location>
    <location x="187" y="841" id="id56">
      <name x="177" y="807">hold</name>
      <label x="177" y="858" kind="invariant">B_c&lt;=28116</label>
    </location>
    <location x="374" y="-93" id="id57">
      <name x="382" y="-127">goto_idle</name>
      <committed />
    </location>
    <location x="-561" y="603" id="id58">
      <name x="-612" y="569">ex_jam</name>
      <label x="-646" y="586" kind="invariant">B_c&lt;=781</label>
    </location>
    <location x="-161" y="841" id="id59">
      <name x="-171" y="807">until_silence</name>
      <label x="-178" y="790" kind="invariant">B_c&lt;=781</label>
    </location>
    <location x="187" y="374" id="id60">
      <name x="177" y="340">sample</name>
      <label x="204" y="365" kind="invariant">B_c&lt;=781</label>
    </location>
    <location x="187" y="603" id="id61">
      <name x="204" y="586">call_observe</name>
      <committed />
    </location>
    <location x="-161" y="603" id="id62">
      <name x="-171" y="569">call_check</name>
      <committed />
    </location>
    <location x="-705" y="221" id="id63">
      <name x="-715" y="187">nPf</name>
      <committed />
    </location>
    <location x="-561" y="374" id="id64">
      <name x="-620" y="374">newPn</name>
      <label x="-620" y="391" kind="invariant">B_c&lt;=40</label>
    </location>
    <location x="187" y="34" id="id65">
      <name x="93" y="8">ex_silence2</name>
      <label x="102" y="25" kind="invariant">B_c&lt;=781</label>
    </location>
    <location x="-561" y="221" id="id66">
      <name x="-561" y="187">check_eof</name>
      <committed />
    </location>
    <location x="-561" y="34" id="id67">
      <name x="-595" y="0">stop</name>
      <label x="-663" y="25" kind="invariant">B_c&lt;=50000</label>
    </location>
    <location x="-561" y="-195" id="id68">
      <name x="-595" y="-229">idle</name>
      <label x="-595" y="-178" kind="invariant">B_c&lt;=781</label>
    </location>
    <location x="187" y="-195" id="id69">
      <name x="177" y="-229">ex_silence1</name>
      <label x="204" y="-212" kind="invariant">B_c&lt;=2343</label>
    </location>
    <location x="-306" y="-8" id="id70">
      <name x="-408" y="-34">other_started</name>
      <label x="-408" y="-17" kind="invariant">B_c &lt;= 3124</label>
    </location>
    <location x="-306" y="-195" id="id71">
      <name x="-316" y="-229">ex_start</name>
      <committed />
    </location>
    <location x="-688" y="-195" id="id72">
      <name x="-698" y="-229">start</name>
    </location>
    <init ref="id72" />
    <transition>
      <source ref="id54" />
      <target ref="id55" />
      <label x="0" y="0" kind="guard">B_c == 25000&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-416" y="1062" kind="synchronisation">B_res_reset!</label>
      <label x="-416" y="1105" kind="assignment">B_Pn=1,
B_start=0,
B_res=0,
B_c=0</label>
      <nail x="357" y="1105" />
      <nail x="357" y="221" />
    </transition>
    <transition>
      <source ref="id56" />
      <target ref="id57" />
      <label x="0" y="0" kind="guard">B_c == 28116&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="238" y="807" kind="synchronisation">B_res_reset!</label>
      <label x="238" y="841" kind="assignment">B_res=0</label>
      <nail x="399" y="841" />
      <nail x="399" y="-93" />
    </transition>
    <transition>
      <source ref="id58" />
      <target ref="id54" />
      <label x="0" y="0" kind="guard">B_c == 781 &amp;&amp;
B_res == 1&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-561" y="837" kind="synchronisation">B_reset!</label>
      <label x="-561" y="854" kind="assignment">B_Pn=0,
B_c=0</label>
    </transition>
    <transition>
      <source ref="id59" />
      <target ref="id59" />
      <label x="0" y="0" kind="guard">B_c == 781&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-204" y="918" kind="synchronisation">zero?</label>
      <label x="-204" y="935" kind="assignment">B_c=0</label>
      <nail x="-204" y="901" />
      <nail x="-119" y="901" />
    </transition>
    <transition>
      <source ref="id58" />
      <target ref="id59" />
      <label x="0" y="0" kind="guard">B_c == 781 &amp;&amp;
B_res == 2&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-297" y="697" kind="synchronisation">B_reset!</label>
      <label x="-297" y="714" kind="assignment">B_Pn=1,
B_start=0,
B_c=0</label>
    </transition>
    <transition>
      <source ref="id59" />
      <target ref="id56" />
      <label x="0" y="0" kind="guard">B_c == 781&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-25" y="824" kind="synchronisation">one?</label>
      <label x="-25" y="841" kind="assignment">B_c=0</label>
    </transition>
    <transition>
      <source ref="id60" />
      <target ref="id61" />
      <label x="0" y="0" kind="guard">B_c == 781&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="187" y="459" kind="synchronisation">one?</label>
      <label x="187" y="476" kind="assignment">B_S2=1</label>
    </transition>
    <transition>
      <source ref="id60" />
      <target ref="id61" />
      <label x="0" y="0" kind="guard">B_c == 781&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="85" y="459" kind="synchronisation">zero?</label>
      <label x="85" y="476" kind="assignment">B_S2=0</label>
      <nail x="170" y="425" />
      <nail x="170" y="578" />
    </transition>
    <transition>
      <source ref="id61" />
      <target ref="id62" />
      <label x="0" y="0" kind="guard">mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-51" y="586" kind="synchronisation">B_observe!</label>
    </transition>
    <transition>
      <source ref="id62" />
      <target ref="id58" />
      <label x="0" y="0" kind="guard">B_stop == 1&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-510" y="527" kind="synchronisation">B_res_reset!</label>
      <label x="-509" y="561" kind="assignment">B_res=0,
B_c=0</label>
      <nail x="-187" y="561" />
      <nail x="-527" y="561" />
    </transition>
    <transition>
      <source ref="id62" />
      <target ref="id58" />
      <label x="0" y="0" kind="guard">B_stop == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-365" y="603" kind="synchronisation">B_check!</label>
      <label x="-365" y="620" kind="assignment">B_c=0</label>
    </transition>
    <transition>
      <source ref="id58" />
      <target ref="id63" />
      <label x="0" y="0" kind="guard">B_c == 781 &amp;&amp;
B_res == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <nail x="-705" y="603" />
    </transition>
    <transition>
      <source ref="id64" />
      <target ref="id60" />
      <label x="0" y="0" kind="guard">B_c == 40 &amp;&amp;
B_err &gt; 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-161" y="433" kind="assignment">B_Pn=1</label>
      <nail x="-518" y="416" />
      <nail x="153" y="416" />
    </transition>
    <transition>
      <source ref="id64" />
      <target ref="id60" />
      <label x="0" y="0" kind="guard">B_c == 40 &amp;&amp;
B_err == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-272" y="374" kind="synchronisation">B_new_Pn!</label>
    </transition>
    <transition>
      <source ref="id65" />
      <target ref="id55" />
      <label x="0" y="0" kind="guard">B_c == 781&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="187" y="110" kind="synchronisation">one?</label>
      <label x="187" y="127" kind="assignment">B_c=0</label>
    </transition>
    <transition>
      <source ref="id55" />
      <target ref="id66" />
      <label x="0" y="0" kind="guard">B_c == 781&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-374" y="204" kind="synchronisation">B_frame!</label>
      <label x="-374" y="221" kind="assignment">B_err=0,
B_diff=0,
B_Pf=1</label>
    </transition>
    <transition>
      <source ref="id66" />
      <target ref="id64" />
      <label x="0" y="0" kind="guard">B_eof == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-527" y="297" kind="synchronisation">one?</label>
      <label x="-535" y="314" kind="assignment">B_S1=1,
B_c=0</label>
      <nail x="-527" y="289" />
    </transition>
    <transition>
      <source ref="id66" />
      <target ref="id64" />
      <label x="0" y="0" kind="guard">B_eof == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-637" y="314" kind="synchronisation">zero?</label>
      <label x="-637" y="331" kind="assignment">B_S1=0,
B_c=0</label>
      <nail x="-595" y="289" />
    </transition>
    <transition>
      <source ref="id63" />
      <target ref="id66" />
      <label x="0" y="0" kind="guard">B_Pn == 1&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-687" y="242" kind="assignment">B_Pf=1</label>
      <nail x="-629" y="263" />
    </transition>
    <transition>
      <source ref="id63" />
      <target ref="id66" />
      <label x="0" y="0" kind="guard">B_Pn == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-688" y="187" kind="assignment">B_Pf=0</label>
      <nail x="-629" y="187" />
    </transition>
    <transition>
      <source ref="id66" />
      <target ref="id67" />
      <label x="0" y="0" kind="guard">B_eof == 1&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-561" y="110" kind="assignment">B_c=0</label>
    </transition>
    <transition>
      <source ref="id57" />
      <target ref="id68" />
      <label x="0" y="0" kind="guard">mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-119" y="-314" kind="assignment">B_c=0</label>
      <nail x="374" y="-297" />
      <nail x="-561" y="-297" />
    </transition>
    <transition>
      <source ref="id67" />
      <target ref="id68" />
      <label x="0" y="0" kind="guard">B_c == 50000&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-612" y="-93" kind="assignment">B_c=0</label>
    </transition>
    <transition>
      <source ref="id69" />
      <target ref="id57" />
      <label x="0" y="0" kind="guard">B_c == 2343&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="289" y="-161" kind="synchronisation">zero?</label>
    </transition>
    <transition>
      <source ref="id65" />
      <target ref="id57" />
      <label x="0" y="0" kind="guard">B_c == 781&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="238" y="-42" kind="synchronisation">zero?</label>
    </transition>
    <transition>
      <source ref="id69" />
      <target ref="id65" />
      <label x="0" y="0" kind="guard">B_c == 2343&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="153" y="-93" kind="synchronisation">one?</label>
      <label x="144" y="-76" kind="assignment">B_c=0</label>
    </transition>
    <transition>
      <source ref="id70" />
      <target ref="id69" />
      <label x="0" y="0" kind="guard">B_c == 3124 &amp;&amp;
A_start == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-178" y="-93" kind="assignment">B_c = 0</label>
    </transition>
    <transition>
      <source ref="id70" />
      <target ref="id70" />
      <label x="0" y="0" kind="guard">B_c == 3124 &amp;&amp;
A_start == 1&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-323" y="76" kind="assignment">B_c=0</label>
      <nail x="-272" y="42" />
      <nail x="-332" y="42" />
    </transition>
    <transition>
      <source ref="id71" />
      <target ref="id70" />
      <label x="0" y="0" kind="guard">A_start == 1&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-306" y="-119" kind="assignment">B_c = 0</label>
    </transition>
    <transition>
      <source ref="id71" />
      <target ref="id69" />
      <label x="0" y="0" kind="guard">A_start == 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-161" y="-195" kind="assignment">B_c=0</label>
    </transition>
    <transition>
      <source ref="id68" />
      <target ref="id71" />
      <label x="0" y="0" kind="guard">B_c == 781&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
    </transition>
    <transition>
      <source ref="id72" />
      <target ref="id68" />
      <label x="0" y="0" kind="guard">mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-654" y="-212" kind="assignment">B_c=0</label>
    </transition>
  </template>
  <template>
    <name x="0" y="0">obs</name>
    <declaration />
    <location x="-161" y="-76" id="id73">
      <committed />
    </location>
    <location x="-246" y="-76" id="id74">
      <committed />
    </location>
    <location x="-161" y="-144" id="id75">
      <committed />
    </location>
    <location x="-255" y="-144" id="id76">
      <committed />
    </location>
    <location x="-68" y="-110" id="id77">
      <name x="-78" y="-144">Failure</name>
    </location>
    <location x="-374" y="-110" id="id78">
      <name x="-442" y="-144">Resolved</name>
    </location>
    <location x="0" y="0" id="id84">
      <name x="0" y="0">Failure_ENTER</name>
      <committed />
    </location>
    <location x="0" y="0" id="id85">
      <name x="0" y="0" />
      <committed />
    </location>
    <location x="0" y="0" id="id91">
      <name x="0" y="0">Resolved_ENTER</name>
      <committed />
    </location>
    <location x="0" y="0" id="id92">
      <name x="0" y="0" />
      <committed />
    </location>
    <location x="0" y="0" id="id93">
      <name x="0" y="0" />
      <committed />
    </location>
    <init ref="id92" />
    <transition>
      <source ref="id74" />
      <target ref="id91" />
      <label x="0" y="0" kind="guard">mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="0" y="0" kind="assignment">mayFire++,
Resolved_holds = 1,
Resolved_held_once = 1</label>
    </transition>
    <transition>
      <source ref="id73" />
      <target ref="id74" />
      <label x="0" y="0" kind="guard">mayFire == 0 &amp;&amp; !nxtCmt</label>
    </transition>
    <transition>
      <source ref="id77" />
      <target ref="id85" />
      <label x="0" y="0" kind="guard">mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="-119" y="-85" kind="synchronisation">B_res_reset?</label>
      <label x="0" y="0" kind="assignment">Failure_holds = 0,
mayFire++</label>
    </transition>
    <transition>
      <source ref="id75" />
      <target ref="id84" />
      <label x="0" y="0" kind="guard">mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="0" y="0" kind="assignment">mayFire++,
Failure_holds = 1,
Failure_held_once = 1</label>
    </transition>
    <transition>
      <source ref="id76" />
      <target ref="id75" />
      <label x="0" y="0" kind="guard">mayFire == 0 &amp;&amp; !nxtCmt</label>
    </transition>
    <transition>
      <source ref="id78" />
      <target ref="id93" />
      <label x="0" y="0" kind="guard">B_res != 0&amp;&amp; mayFire == 0 &amp;&amp; !nxtCmt</label>
      <label x="0" y="0" kind="assignment">Resolved_holds = 0,
mayFire++</label>
    </transition>
    <transition>
      <source ref="id84" />
      <target ref="id77" />
      <label x="0" y="0" kind="synchronisation">Failure_reached!</label>
      <label x="0" y="0" kind="assignment">mayFire--</label>
    </transition>
    <transition>
      <source ref="id85" />
      <target ref="id73" />
      <label x="0" y="0" kind="guard">!nxtCmt</label>
      <label x="0" y="0" kind="assignment">mayFire--</label>
    </transition>
    <transition>
      <source ref="id92" />
      <target ref="id91" />
      <label x="0" y="0" kind="assignment">mayFire++</label>
    </transition>
    <transition>
      <source ref="id91" />
      <target ref="id78" />
      <label x="0" y="0" kind="synchronisation">Resolved_reached!</label>
      <label x="0" y="0" kind="assignment">mayFire--</label>
    </transition>
    <transition>
      <source ref="id93" />
      <target ref="id76" />
      <label x="0" y="0" kind="guard">!nxtCmt</label>
      <label x="0" y="0" kind="assignment">mayFire--</label>
    </transition>
  </template>
  <template>
    <name x="0" y="0">observer</name>
    <declaration>// Place local declarations here.</declaration>
    <location x="-340" y="-178" id="id0">
      <committed />
    </location>
    <location x="153" y="-178" id="id1">
      <name x="143" y="-212">ERROR</name>
    </location>
    <location x="-476" y="-178" id="id2" />
    <location x="-25" y="-178" id="id3" />
    <location x="-195" y="-178" id="id4" />
    <init ref="id2" />
    <transition>
      <source ref="id0" />
      <target ref="id2" />
      <label x="-459" y="-153" kind="guard">EOF_Reset_holds == 1</label>
      <label x="-450" y="-136" kind="assignment">nxtCmt = 0</label>
      <nail x="-357" y="-153" />
      <nail x="-459" y="-153" />
    </transition>
    <transition>
      <source ref="id0" />
      <target ref="id4" />
      <label x="-314" y="-195" kind="guard">EOF_Reset_holds == 0</label>
      <label x="-322" y="-178" kind="assignment">nxtCmt = 0</label>
    </transition>
    <transition>
      <source ref="id2" />
      <target ref="id0" />
      <label x="-458" y="-195" kind="synchronisation">startA_reached?</label>
      <label x="-458" y="-178" kind="assignment">nxtCmt = 1</label>
    </transition>
    <transition>
      <source ref="id4" />
      <target ref="id2" />
      <label x="-382" y="-119" kind="synchronisation">EOF_Reset_reached?</label>
      <nail x="-195" y="-93" />
      <nail x="-476" y="-93" />
    </transition>
    <transition>
      <source ref="id3" />
      <target ref="id1" />
      <label x="25" y="-195" kind="synchronisation">EOF_Reset_reached?</label>
    </transition>
    <transition>
      <source ref="id3" />
      <target ref="id4" />
      <label x="-153" y="-102" kind="synchronisation">Resolved_reached?</label>
      <nail x="-119" y="-110" />
    </transition>
    <transition>
      <source ref="id4" />
      <target ref="id3" />
      <label x="-153" y="-195" kind="synchronisation">Failure_reached?</label>
    </transition>
  </template>
  <system>Observer = observer();
// Place template instantiations here.
bus = Bus();
frameA = Frame_Generator_A();
frameB = Frame_Generator_B();
detectorA = Detector_A();
detectorB = Detector_B();
senderA = Sender_A();
senderB = Sender_B();
o = obs();
// List one or more processes to be composed into a system.
    
system bus, frameA, frameB, detectorA, detectorB, senderA, senderB, o, Observer;</system>
  <queries>
    <query>
      <formula>A[] not Observer.ERROR</formula>
      <comment />
    </query>
  </queries>
</nta>

